<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MI PLAYER PRO - Kaushal Ji Edition</title>
    
    <style>
        :root { 
            --main-clr: #00ffcc; --bg-dark: #080808;
            --glass: rgba(255, 255, 255, 0.05);
            --accent-gradient: linear-gradient(135deg, #00ffcc 0%, #0099ff 100%);
        }

        body { 
            margin: 0; background: #000; 
            display: flex; justify-content: center; align-items: center; 
            height: 100vh; font-family: 'Segoe UI', sans-serif; color: #fff; overflow: hidden; 
        }
        
        /* Device Frames */
        .phone { 
            width: 350px; height: 700px; background: var(--bg-dark); 
            border: 8px solid #1a1a1a; border-radius: 45px; position: relative; 
            display: flex; flex-direction: column; transition: 0.5s; 
            box-shadow: 0 0 50px rgba(0, 255, 204, 0.2);
        }

        /* Laptop View Layout */
        .laptop-view { 
            width: 95% !important; max-width: 1200px; height: 85% !important; border-radius: 20px !important; 
        }
        .laptop-view .main-layout { flex-direction: row !important; }
        .laptop-view .player-section { flex: 2; border-right: 1px solid #222; }
        .laptop-view .playlist-section { display: block !important; flex: 1; max-height: 100%; overflow-y: auto; padding: 15px; }

        .main-layout { display: flex; flex-direction: column; flex: 1; overflow: hidden; }
        .playlist-section { display: none; } /* Default hidden in mobile */

        /* Header & Status */
        .status-bar { display: flex; justify-content: space-between; padding: 15px 25px 5px; font-size: 11px; color: var(--main-clr); }
        .header { padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; background: var(--glass); border-bottom: 1px solid #222; }

        /* Support Menu */
        #support-menu {
            position: absolute; top: 70px; right: 20px; background: #111; 
            border: 1px solid var(--main-clr); border-radius: 12px; display: none; 
            flex-direction: column; z-index: 2000; width: 200px; overflow: hidden;
        }
        .menu-item { padding: 12px; font-size: 13px; border-bottom: 1px solid #222; cursor: pointer; transition: 0.2s; }
        .menu-item:hover { background: var(--main-clr); color: #000; }

        /* Player UI */
        .player-section { padding: 20px; text-align: center; display: flex; flex-direction: column; align-items: center; overflow-y: auto; width: 100%; box-sizing: border-box; }
        .video-box { width: 100%; max-width: 500px; height: 220px; background: #000; border-radius: 15px; display: none; margin-bottom: 15px; border: 1px solid #333; }
        .img-display { width: 100%; max-width: 400px; height: 300px; object-fit: contain; display: none; border-radius: 10px; }
        
        .visualizer { width: 120px; height: 120px; border-radius: 50%; border: 3px solid var(--main-clr); margin: 20px; overflow: hidden; }
        .visualizer img { width: 100%; height: 100%; object-fit: cover; }

        .controls { display: flex; align-items: center; gap: 30px; margin: 20px 0; }
        .play-btn { width: 60px; height: 60px; border-radius: 50%; background: var(--accent-gradient); border: none; font-size: 24px; cursor: pointer; box-shadow: 0 0 15px rgba(0,255,204,0.3); }

        /* Overlays */
        .overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.9); z-index: 3000; display: none; justify-content: center; align-items: center; backdrop-filter: blur(10px); }
        .card { background: #111; padding: 25px; border-radius: 20px; width: 85%; max-width: 320px; border: 1px solid var(--main-clr); }
        input { width: 100%; padding: 12px; margin: 10px 0; background: #000; border: 1px solid #333; color: #fff; border-radius: 8px; box-sizing: border-box; }

        /* Action Buttons */
        .btn-row { display: flex; gap: 8px; margin-top: 15px; flex-wrap: wrap; justify-content: center; }
        .file-label { padding: 10px 15px; background: #222; border-radius: 10px; font-size: 12px; cursor: pointer; border: 1px solid #444; }
    </style>
</head>
<body>

<div class="phone" id="main-frame">
    <div class="status-bar">
        <span id="live-time">00:00:00</span>
        <span id="live-battery">BAT: 100%</span>
    </div>

    <div id="auth-overlay" class="overlay">
        <div class="card">
            <h3 id="auth-title" style="color:var(--main-clr); margin-top:0;">Elite Login</h3>
            <input type="text" id="reg-name" placeholder="Full Name">
            <input type="number" id="reg-phone" placeholder="Mobile Number">
            <input type="password" id="reg-pass" placeholder="Password">
            <button class="play-btn" style="width:100%; border-radius:10px;" onclick="handleAuth()">Submit</button>
            <p onclick="closeOverlays()" style="text-align:center; color:red; cursor:pointer; margin-top:15px;">Cancel</p>
        </div>
    </div>

    <div id="upi-overlay" class="overlay">
        <div class="card" style="text-align:center;">
            <h3 style="color:var(--main-clr);">Support Kaushal Ji</h3>
            <p>UPI ID: <b>mandavikaushal913@okaxis</b></p>
            <div style="background:white; padding:10px; display:inline-block; border-radius:10px;">
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=upi://pay?pa=mandavikaushal913@okaxis&pn=Kaushal%20Ji" width="150">
            </div>
            <button class="play-btn" style="width:100%; border-radius:10px; margin-top:15px;" onclick="closeOverlays()">Done</button>
        </div>
    </div>

    <div class="header">
        <div id="user-pfp" style="width:35px; height:35px; background:#333; border-radius:50%; overflow:hidden;">üë§</div>
        <div style="text-align:center;">
            <b style="font-size:14px; color:var(--main-clr);">MI PLAYER PRO</b>
            <select onchange="changeView(this.value)" style="display:block; background:none; color:#888; border:none; font-size:10px; margin:auto;">
                <option value="android">Mobile View</option>
                <option value="laptop">Laptop View</option>
            </select>
        </div>
        <div style="display:flex; gap:12px;">
            <span onclick="openAuth()" style="cursor:pointer;">‚öôÔ∏è</span>
            <span onclick="toggleSupport(event)" style="cursor:pointer; color:var(--main-clr); font-weight:bold;">‚ãÆ</span>
        </div>
    </div>

    <div id="support-menu">
        <div class="menu-item" onclick="window.open('https://wa.me/919129191898')">üí¨ WhatsApp</div>
        <div class="menu-item" onclick="window.location.href='tel:9129191898'">üìû Call Support</div>
        <div class="menu-item" onclick="document.getElementById('upi-overlay').style.display='flex'">üí∞ Support by UPI</div>
        <div class="menu-item" onclick="shareApp()">üì§ Share App</div>
    </div>

    <div class="main-layout">
        <div class="player-section">
            <div id="display-name" style="font-weight:bold; font-size:18px;">Welcome</div>
            <div style="color:var(--main-clr); font-size:12px; margin-bottom:10px;">Elite Member</div>

            <div class="visualizer" id="music-ui">
                <img id="track-art" src="https://harshitkaushal9129-bit.github.io/Calculator/kaushal.jpg">
            </div>

            <div class="video-box" id="video-ui"><video id="vid-player" style="width:100%; height:100%;" controls></video></div>
            <img id="img-ui" class="img-display">

            <h4 id="track-name" style="margin:10px 0; font-size:14px;">No Media Loaded</h4>

            <input type="range" id="seek-slider" value="0" style="width:90%;">
            
            <div class="controls">
                <button onclick="prevT()" style="background:none; border:none; color:white; font-size:24px;">‚èÆ</button>
                <button id="play-btn" class="play-btn" onclick="togglePlay()">‚ñ∂</button>
                <button onclick="nextT()" style="background:none; border:none; color:white; font-size:24px;">‚è≠</button>
            </div>

            <div class="btn-row">
                <label class="file-label">üéµ Music <input type="file" hidden multiple accept="audio/*" onchange="loadMedia(event, 'music')"></label>
                <label class="file-label">üé• Video <input type="file" hidden multiple accept="video/*" onchange="loadMedia(event, 'video')"></label>
                <label class="file-label">üñº Image <input type="file" hidden multiple accept="image/*" onchange="loadMedia(event, 'image')"></label>
            </div>
        </div>

        <div class="playlist-section" id="side-playlist">
            <h3 style="color:var(--main-clr); border-bottom:1px solid #333; padding-bottom:10px;">Playlist</h3>
            <div id="playlist-items"></div>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
    // Firebase Setup (Wahi rakha hai jo aapne diya)
    const firebaseConfig = {
        apiKey: "AIzaSyDQ0Y8M9OGSInOlUltuysgmKOYGKX8dQvg",
        authDomain: "calculator-by-kaushalji.firebaseapp.com",
        databaseURL: "https://calculator-by-kaushalji-default-rtdb.firebaseio.com",
        projectId: "calculator-by-kaushalji",
        storageBucket: "calculator-by-kaushalji.firebasestorage.app",
        messagingSenderId: "156130281294",
        appId: "1:156130281294:web:73b80a5f344daeabdd001f"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let playlist = [], trackIdx = 0, currentUser = null;
    let audio = new Audio();
    let video = document.getElementById('vid-player');
    let currentActive = audio;

    // --- Authentication ---
    function openAuth() { document.getElementById('auth-overlay').style.display = 'flex'; }
    function closeOverlays() { document.querySelectorAll('.overlay').forEach(o => o.style.display='none'); }

    async function handleAuth() {
        const name = document.getElementById('reg-name').value;
        const phone = document.getElementById('reg-phone').value;
        const pass = document.getElementById('reg-pass').value;

        if(!phone || !pass) return alert("Fill details!");

        const snap = await db.ref('users/' + phone).once('value');
        if(snap.exists()) {
            if(snap.val().password === pass) login(snap.val());
            else alert("Wrong password!");
        } else {
            const user = { name, phone, password: pass };
            await db.ref('users/' + phone).set(user);
            login(user);
        }
    }

    function login(user) {
        currentUser = user;
        document.getElementById('display-name').innerText = user.name;
        closeOverlays();
        loadCloudPlaylist();
    }

    // --- Media Core ---
    async function loadMedia(e, type) {
        const files = Array.from(e.target.files);
        for(let f of files) {
            const reader = new FileReader();
            reader.readAsDataURL(f);
            reader.onload = async () => {
                const item = { name: f.name, url: reader.result, type: type };
                playlist.push(item);
                if(currentUser) db.ref('playlists/' + currentUser.phone).push(item);
                updatePlaylistUI();
            };
        }
    }

    function updatePlaylistUI() {
        const container = document.getElementById('playlist-items');
        container.innerHTML = "";
        playlist.forEach((item, i) => {
            const div = document.createElement('div');
            div.style = "padding:10px; border-bottom:1px solid #222; cursor:pointer; font-size:12px;";
            div.innerHTML = (item.type === 'music' ? 'üéµ ' : item.type === 'video' ? 'üé• ' : 'üñº ') + item.name;
            div.onclick = () => playT(i);
            container.appendChild(div);
        });
    }

    function playT(i) {
        trackIdx = i;
        const item = playlist[i];
        
        // Reset Displays
        document.getElementById('music-ui').style.display = 'none';
        document.getElementById('video-ui').style.display = 'none';
        document.getElementById('img-ui').style.display = 'none';
        audio.pause(); video.pause();

        document.getElementById('track-name').innerText = item.name;

        if(item.type === 'music') {
            document.getElementById('music-ui').style.display = 'block';
            currentActive = audio;
            audio.src = item.url; audio.play();
        } else if(item.type === 'video') {
            document.getElementById('video-ui').style.display = 'block';
            currentActive = video;
            video.src = item.url; video.play();
        } else {
            document.getElementById('img-ui').style.display = 'block';
            document.getElementById('img-ui').src = item.url;
        }
        document.getElementById('play-btn').innerText = '‚è∏';
    }

    function togglePlay() {
        if(currentActive.paused) { currentActive.play(); document.getElementById('play-btn').innerText = '‚è∏'; }
        else { currentActive.pause(); document.getElementById('play-btn').innerText = '‚ñ∂'; }
    }

    function nextT() { if(trackIdx < playlist.length-1) playT(trackIdx+1); }
    function prevT() { if(trackIdx > 0) playT(trackIdx-1); }

    // --- Utility ---
    function changeView(v) {
        const frame = document.getElementById('main-frame');
        frame.className = 'phone ' + (v === 'laptop' ? 'laptop-view' : '');
    }

    function toggleSupport(e) {
        e.stopPropagation();
        const m = document.getElementById('support-menu');
        m.style.display = m.style.display === 'flex' ? 'none' : 'flex';
    }

    function shareApp() {
        if (navigator.share) {
            navigator.share({ title: 'MI PLAYER PRO', url: window.location.href });
        } else {
            alert("Copy Link: " + window.location.href);
        }
    }

    setInterval(() => {
        document.getElementById('live-time').innerText = new Date().toLocaleTimeString();
    }, 1000);

    window.onclick = () => document.getElementById('support-menu').style.display='none';
</script>

</body>
</html>
