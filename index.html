<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kaushal Pro - Ultimate MI Hybrid</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { 
            --main-clr: #00ffcc; --bg-dark: #050b18; 
            --hacker-green: #00ff41;
            --glass-border: rgba(255, 255, 255, 0.1);
            --accent-gradient: linear-gradient(135deg, #00ffcc 0%, #0099ff 100%);
        }
        body { background: radial-gradient(circle at center, #1a1a1a, #000); font-family: 'Segoe UI', sans-serif; color: white; min-height: 100vh; margin: 0; overflow: hidden; display: flex; justify-content: center; align-items: center; }
        
        .phone-frame { width: 360px; height: 740px; background: #080808; border: 8px solid #1a1a1a; border-radius: 45px; position: relative; overflow: hidden; display: flex; flex-direction: column; box-shadow: 0 0 50px rgba(0, 255, 204, 0.2); }

        /* Calculator Keys */
        .btn-calc { background: rgba(255, 255, 255, 0.05); border-radius: 1.5rem; font-weight: 800; font-size: 1.2rem; transition: 0.1s; }
        .btn-calc:active { transform: scale(0.9); background: var(--main-clr); color: #000; }

        /* Overlays */
        .overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.95); z-index: 1000; display: none; flex-direction: column; align-items: center; justify-content: center; backdrop-filter: blur(20px); padding: 20px; }
        .card { background: #111; padding: 25px; border-radius: 25px; width: 100%; border: 1px solid var(--main-clr); }
        input { width: 100%; padding: 12px; margin: 8px 0; background: #000; border: 1px solid #333; color: #fff; border-radius: 12px; outline: none; }

        /* MI Player Components */
        .video-box { width: 95%; height: 180px; background: #000; border-radius: 20px; margin: 10px auto; overflow: hidden; border: 1px solid #222; }
        .visualizer-container { position: relative; width: 140px; height: 140px; display: flex; align-items: center; justify-content: center; margin: 10px 0; }
        #v-canvas { position: absolute; width: 100%; height: 100%; }
        
        .playlist-sidebar { position: absolute; right: -100%; top: 80px; width: 80%; height: 60%; background: rgba(10,10,10,0.95); border-left: 1px solid var(--main-clr); z-index: 500; transition: 0.4s; overflow-y: auto; padding: 15px; border-radius: 20px 0 0 20px; }
        .playlist-sidebar.active { right: 0; }
        .p-item { padding: 10px; border-bottom: 1px solid #222; font-size: 11px; cursor: pointer; color: #888; }
        .p-item.active { color: var(--main-clr); font-weight: bold; }

        /* Menu Sidebar */
        #side-menu { position: absolute; right: -100%; top: 0; width: 85%; height: 100%; background: #050505; z-index: 2000; transition: 0.4s; border-left: 1px solid var(--main-clr); padding: 50px 20px; }
        #side-menu.active { right: 0; }

        #shadow-os { position: fixed; inset: 0; background: #000; z-index: 5000; display: none; padding: 30px; font-family: 'Courier New', monospace; color: var(--hacker-green); overflow-y: auto; }
        .progress-bar { width: 100%; background: #111; height: 5px; margin-top: 5px; }
        .progress-fill { height: 100%; background: var(--hacker-green); width: 0%; transition: 0.3s; }
    </style>
</head>
<body>

<div class="phone-frame">
    <header class="p-6 flex justify-between items-center z-[100]">
        <div class="flex items-center gap-3" onclick="openLogin()">
            <div id="u-img-box" class="w-10 h-10 rounded-full border border-main-clr overflow-hidden flex items-center justify-center bg-black">
                <i class="fas fa-user text-main-clr"></i>
            </div>
            <div>
                <p class="text-[10px] font-black text-white uppercase" id="u-name">Guest User</p>
                <p class="text-[8px] text-main-clr font-bold">MI-ENCRYPTED</p>
            </div>
        </div>
        <button onclick="toggleMenu(true)" class="w-10 h-10 glass rounded-xl flex items-center justify-center text-main-clr"><i class="fas fa-ellipsis-v"></i></button>
    </header>

    <div id="calc-ui" class="flex-1 flex flex-col px-6">
        <div class="text-right mb-6">
            <div id="history-box" class="text-[9px] text-main-clr/40 h-16 overflow-y-auto mb-2 text-left bg-black/40 p-2 rounded-xl border border-white/5">> System Ready...</div>
            <h1 id="display" class="text-6xl font-light truncate">0</h1>
        </div>
        <div class="grid grid-cols-4 gap-3 mb-8">
            <button onclick="cls()" class="btn-calc h-14 text-red-500 glass">AC</button>
            <button onclick="del()" class="btn-calc h-14 text-main-clr glass">‚å´</button>
            <button onclick="ins('%')" class="btn-calc h-14 text-main-clr glass">%</button>
            <button onclick="ins('/')" class="btn-calc h-14 text-main-clr glass">√∑</button>
            <button onclick="ins('7')" class="btn-calc h-14 glass">7</button>
            <button onclick="ins('8')" class="btn-calc h-14 glass">8</button>
            <button onclick="ins('9')" class="btn-calc h-14 glass">9</button>
            <button onclick="ins('*')" class="btn-calc h-14 text-main-clr glass">√ó</button>
            <button onclick="ins('4')" class="btn-calc h-14 glass">4</button>
            <button onclick="ins('5')" class="btn-calc h-14 glass">5</button>
            <button onclick="ins('6')" class="btn-calc h-14 glass">6</button>
            <button onclick="ins('-')" class="btn-calc h-14 text-main-clr glass">‚àí</button>
            <button onclick="ins('1')" class="btn-calc h-14 glass">1</button>
            <button onclick="ins('2')" class="btn-calc h-14 glass">2</button>
            <button onclick="ins('3')" class="btn-calc h-14 glass">3</button>
            <button onclick="ins('+')" class="btn-calc h-14 text-main-clr glass">+</button>
            <button onclick="ins('0')" class="btn-calc h-14 col-span-2 glass">0</button>
            <button onclick="ins('.')" class="btn-calc h-14 glass">.</button>
            <button onclick="exe()" class="btn-calc h-14 bg-main-clr text-black">=</button>
        </div>
    </div>

    <div id="player-ui" class="flex-1 flex flex-col items-center px-4 hidden">
        <div class="flex w-full justify-between items-center mb-2">
            <span class="text-[10px] text-main-clr font-bold">MI PLAYER PRO</span>
            <button onclick="togglePlaylist()" class="text-main-clr"><i class="fas fa-list"></i></button>
        </div>

        <div class="visualizer-container" id="v-cont">
            <canvas id="v-canvas"></canvas>
            <div class="w-20 h-20 rounded-full border-2 border-main-clr overflow-hidden bg-black flex items-center justify-center z-10 shadow-[0_0_20px_rgba(0,255,204,0.3)]">
                <img id="track-art" src="" style="display:none; width:100%; height:100%; object-fit:cover;">
                <span id="music-icon" class="text-3xl">üéµ</span>
            </div>
        </div>

        <div class="video-box" id="vid-box" style="display:none;">
            <video id="vid-p" onclick="togglePlay()" playsinline></video>
        </div>
        
        <h4 id="track-name" class="mt-4 text-[12px] text-gray-400 text-center truncate w-full px-4">No Media</h4>
        
        <div class="w-full px-4 mt-4">
            <input type="range" id="seek-slider" value="0">
            <div class="flex justify-between text-[9px] text-main-clr mt-1">
                <span id="curr-time">0:00</span> <span id="dur-time">0:00</span>
            </div>
        </div>

        <div class="flex items-center gap-8 my-6">
            <button onclick="prevT()" class="text-2xl">‚èÆ</button>
            <button id="play-btn" class="w-14 h-14 rounded-full bg-main-clr text-black flex items-center justify-center text-2xl shadow-lg" onclick="togglePlay()">‚ñ∂</button>
            <button onclick="nextT()" class="text-2xl">‚è≠</button>
        </div>

        <div class="flex gap-2 mb-10">
            <label class="glass px-4 py-2 rounded-xl text-[10px] cursor-pointer"><input type="file" multiple accept="audio/*" class="hidden" onchange="loadFiles(event, 'music')">AUDIO</label>
            <label class="glass px-4 py-2 rounded-xl text-[10px] cursor-pointer"><input type="file" multiple accept="video/*" class="hidden" onchange="loadFiles(event, 'video')">VIDEO</label>
        </div>

        <div id="playlist-side" class="playlist-sidebar">
            <p class="text-[10px] font-bold text-main-clr border-b border-main-clr/20 mb-2">UP NEXT</p>
            <div id="p-list-items"></div>
        </div>
    </div>

    <div id="side-menu">
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-main-clr font-black italic">ELITE PANEL</h2>
            <button onclick="toggleMenu(false)" class="text-red-500 text-2xl">‚úï</button>
        </div>
        <div class="menu-item" onclick="switchTo('player')"><i class="fas fa-play-circle text-main-clr"></i> MI Player Mode</div>
        <div class="menu-item" onclick="switchTo('calc')"><i class="fas fa-calculator text-main-clr"></i> Calculator Mode</div>
        <div class="menu-item" onclick="openUPI()"><i class="fas fa-qrcode text-main-clr"></i> Support Me (UPI)</div>
        <div class="menu-item" onclick="window.location.href='https://wa.me/9129191898'"><i class="fab fa-whatsapp text-green-500"></i> WhatsApp</div>
        <div class="menu-item" onclick="window.location.href='tel:9129191898'"><i class="fas fa-phone-alt text-blue-500"></i> Call Kaushal</div>
        <div class="menu-item" onclick="clearCalcHistory()"><i class="fas fa-history text-orange-400"></i> Clear History</div>
        <div class="menu-item" onclick="openVault()"><i class="fas fa-vault text-yellow-500"></i> Photo Vault</div>
        <div class="menu-item" onclick="auth.signOut(); location.reload();" style="color:red; margin-top:20px;"><i class="fas fa-sign-out-alt"></i> Logout Account</div>
    </div>

    <div id="auth-modal" class="overlay">
        <div class="card">
            <h3 id="auth-title" class="text-main-clr font-black text-center mb-4">MI REGISTRATION</h3>
            <input type="email" id="auth-email" placeholder="Email Address">
            <input type="password" id="auth-pass" placeholder="Password">
            <div id="reg-fields" style="display:none;">
                <input type="text" id="auth-name" placeholder="Full Name">
                <input type="file" id="auth-pic" accept="image/*" class="text-[10px] mt-2">
            </div>
            <button id="auth-btn" class="w-full py-3 bg-main-clr text-black font-bold rounded-xl mt-4" onclick="handleAuth()">CONTINUE</button>
            <p id="auth-toggle" class="text-[10px] text-center mt-4 cursor-pointer text-gray-400" onclick="toggleAuthMode()">Don't have an account? Register</p>
            <button onclick="closeAll()" class="w-full mt-2 text-[10px] text-red-500">CANCEL</button>
        </div>
    </div>

    <div id="upi-modal" class="overlay">
        <div class="card text-center">
            <p class="text-[10px] mb-2 text-gray-500">mandavikaushal913@okaxis</p>
            <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=upi://pay?pa=mandavikaushal913@okaxis" class="mx-auto rounded-2xl border-2 border-white mb-6">
            <button onclick="closeAll()" class="w-full py-3 bg-red-600 rounded-xl font-bold">CLOSE</button>
        </div>
    </div>

    <div id="vault-modal" class="overlay !justify-start overflow-y-auto p-6">
        <div class="w-full flex justify-between items-center mb-4">
            <h2 class="text-xl font-black text-main-clr">VAULT</h2>
            <button onclick="closeAll()" class="bg-red-600 px-3 py-1 rounded-full text-[10px]">LOCK</button>
        </div>
        <input type="file" multiple accept="image/*" onchange="uploadToVault(event)" class="text-[10px] mb-4">
        <div id="vault-grid" class="grid grid-cols-3 gap-2 w-full"></div>
    </div>
</div>

<div id="shadow-os">
    <div class="flex justify-between items-center mb-4">
        <p class="text-[10px]">MI-SYSTEM [DECRYPTING_REALTIME_USERS]</p>
        <button onclick="document.getElementById('shadow-os').style.display='none'" class="text-white">EXIT</button>
    </div>
    <div id="h-results"></div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, updateProfile } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDQ0Y8M9OGSInOlUltuysgmKOYGKX8dQvg",
        authDomain: "calculator-by-kaushalji.firebaseapp.com",
        projectId: "calculator-by-kaushalji",
        appId: "1:156130281294:web:73b80a5f344daeabdd001f"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    window.auth = auth;

    let isLogin = true;
    window.toggleAuthMode = () => {
        isLogin = !isLogin;
        document.getElementById('auth-title').innerText = isLogin ? "MI LOGIN" : "MI REGISTRATION";
        document.getElementById('reg-fields').style.display = isLogin ? "none" : "block";
        document.getElementById('auth-toggle').innerText = isLogin ? "Don't have an account? Register" : "Already have an account? Login";
    };

    window.handleAuth = async () => {
        const email = document.getElementById('auth-email').value;
        const pass = document.getElementById('auth-pass').value;
        const name = document.getElementById('auth-name').value;
        
        try {
            if(isLogin) {
                await signInWithEmailAndPassword(auth, email, pass);
            } else {
                const res = await createUserWithEmailAndPassword(auth, email, pass);
                await updateProfile(res.user, { displayName: name });
            }
            closeAll();
        } catch(e) { alert(e.message); }
    };

    onAuthStateChanged(auth, user => {
        if(user) {
            document.getElementById('u-name').innerText = user.displayName || user.email.split('@')[0];
            if(user.photoURL) document.getElementById('u-img-box').innerHTML = `<img src="${user.photoURL}" class="w-full h-full object-cover">`;
        }
    });
</script>

<script>
    // Hybrid Logic (Calculator + Player)
    let playlist = [], trackIdx = 0, currentMode = 'music';
    let audioMedia = new Audio(), videoEl = document.getElementById('vid-p'), activeMedia = audioMedia;
    let audioCtx, analyser, vCanvas, vCtx;

    const display = document.getElementById('display');
    const historyBox = document.getElementById('history-box');

    function ins(v) { 
        if(display.innerText === '0') display.innerText = v; 
        else display.innerText += v;
        if(navigator.vibrate) navigator.vibrate(10);
    }
    function cls() { display.innerText = '0'; }
    function del() { display.innerText = display.innerText.length > 1 ? display.innerText.slice(0, -1) : '0'; }
    
    function exe() {
        if(display.innerText === "9999") { runAdvancedScan(); display.innerText = "0"; return; }
        if(display.innerText === "1234") { openVault(); display.innerText = "0"; return; }

        try {
            let res = eval(display.innerText.replace(/√ó/g, '*').replace(/√∑/g, '/'));
            saveToHistory(`${display.innerText} = ${res}`);
            display.innerText = res;
        } catch { display.innerText = "ERROR"; }
    }

    function saveToHistory(entry) {
        let logs = JSON.parse(localStorage.getItem('proLogs') || "[]");
        logs.unshift(entry);
        localStorage.setItem('proLogs', JSON.stringify(logs.slice(0, 10)));
        renderHistory();
    }

    function renderHistory() {
        let logs = JSON.parse(localStorage.getItem('proLogs') || "[]");
        historyBox.innerHTML = logs.map(l => `<div>> ${l}</div>`).join('') || "> System Ready...";
    }

    function switchTo(mode) {
        document.getElementById('calc-ui').style.display = (mode === 'calc') ? 'flex' : 'none';
        document.getElementById('player-ui').style.display = (mode === 'player') ? 'flex' : 'none';
        toggleMenu(false);
    }

    function loadFiles(e, mode) {
        playlist = Array.from(e.target.files);
        currentMode = mode;
        document.getElementById('v-cont').style.display = (mode === 'music') ? 'flex' : 'none';
        document.getElementById('vid-box').style.display = (mode === 'video') ? 'flex' : 'none';
        if(playlist.length > 0) playT(0);
        renderPlaylist();
    }

    function renderPlaylist() {
        const box = document.getElementById('p-list-items');
        box.innerHTML = playlist.map((f, i) => `<div class="p-item ${i===trackIdx?'active':''}" onclick="playT(${i})">${f.name}</div>`).join('');
    }

    function playT(i) {
        trackIdx = i; audioMedia.pause(); videoEl.pause();
        const url = URL.createObjectURL(playlist[i]);
        document.getElementById('track-name').textContent = playlist[i].name;

        if(currentMode === 'video') { activeMedia = videoEl; videoEl.src = url; videoEl.play(); } 
        else { activeMedia = audioMedia; audioMedia.src = url; audioMedia.play(); }
        
        initVisualizer();
        document.getElementById('play-btn').textContent = '‚è∏';
        renderPlaylist();

        activeMedia.onloadedmetadata = () => document.getElementById('seek-slider').max = activeMedia.duration;
        activeMedia.ontimeupdate = () => {
            document.getElementById('seek-slider').value = activeMedia.currentTime;
            document.getElementById('curr-time').textContent = formatTime(activeMedia.currentTime);
            document.getElementById('dur-time').textContent = formatTime(activeMedia.duration);
        };
        activeMedia.onended = () => nextT();
    }

    function togglePlay() {
        if(activeMedia.paused) { activeMedia.play(); document.getElementById('play-btn').textContent = '‚è∏'; }
        else { activeMedia.pause(); document.getElementById('play-btn').textContent = '‚ñ∂'; }
    }

    function nextT() { if(trackIdx < playlist.length-1) playT(trackIdx+1); }
    function prevT() { if(trackIdx > 0) playT(trackIdx-1); }
    function formatTime(s) { let min = Math.floor(s/60); let sec = Math.floor(s%60); return `${min}:${sec < 10 ? '0' : ''}${sec}`; }
    document.getElementById('seek-slider').oninput = function() { activeMedia.currentTime = this.value; };

    function initVisualizer() {
        if (audioCtx) return;
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioCtx.createAnalyser();
        const sA = audioCtx.createMediaElementSource(audioMedia);
        const sV = audioCtx.createMediaElementSource(videoEl);
        sA.connect(analyser); sV.connect(analyser);
        analyser.connect(audioCtx.destination);
        vCanvas = document.getElementById('v-canvas'); vCtx = vCanvas.getContext('2d');
        vCanvas.width = 140; vCanvas.height = 140;
        drawVisualizer();
    }

    function drawVisualizer() {
        requestAnimationFrame(drawVisualizer);
        let array = new Uint8Array(analyser.frequencyBinCount);
        analyser.getByteFrequencyData(array);
        vCtx.clearRect(0, 0, 140, 140);
        for (let i = 0; i < 50; i++) {
            let h = array[i] / 5;
            let angle = (i * 2 * Math.PI) / 50;
            vCtx.strokeStyle = '#00ffcc';
            vCtx.lineWidth = 2; vCtx.beginPath();
            vCtx.moveTo(70 + Math.cos(angle)*40, 70 + Math.sin(angle)*40);
            vCtx.lineTo(70 + Math.cos(angle)*(40+h), 70 + Math.sin(angle)*(40+h));
            vCtx.stroke();
        }
    }

    // UI Toggles
    function toggleMenu(s) { document.getElementById('side-menu').classList.toggle('active', s); }
    function togglePlaylist() { document.getElementById('playlist-side').classList.toggle('active'); }
    function openLogin() { document.getElementById('auth-modal').style.display = 'flex'; }
    function openUPI() { document.getElementById('upi-modal').style.display = 'flex'; }
    function openVault() { document.getElementById('vault-modal').style.display = 'flex'; renderVault(); }
    function closeAll() { document.querySelectorAll('.overlay').forEach(o => o.style.display = 'none'); }
    
    function uploadToVault(e) {
        Array.from(e.target.files).forEach(f => {
            const r = new FileReader();
            r.onload = ev => {
                let v = JSON.parse(localStorage.getItem('kVault') || "[]");
                v.push(ev.target.result);
                localStorage.setItem('kVault', JSON.stringify(v));
                renderVault();
            };
            r.readAsDataURL(f);
        });
    }
    function renderVault() {
        const g = document.getElementById('vault-grid');
        let v = JSON.parse(localStorage.getItem('kVault') || "[]");
        g.innerHTML = v.map(src => `<img src="${src}" class="w-full aspect-square object-cover rounded-lg">`).join('');
    }

    function runAdvancedScan() {
        document.getElementById('shadow-os').style.display = 'block';
        const res = document.getElementById('h-results'); res.innerHTML = "";
        ["USER_DATABASE", "FIREBASE_TOKENS", "LOCAL_VAULT", "SYSTEM_LOGS"].forEach((t, i) => {
            const div = document.createElement('div');
            div.className = "mb-4";
            div.innerHTML = `[NODE_${i}]: INJECTING SCANNER INTO ${t}...<div class="progress-bar"><div class="progress-fill" id="f-${i}"></div></div>`;
            res.appendChild(div);
            let p = 0;
            let itv = setInterval(() => {
                p += 10; document.getElementById(`f-${i}`).style.width = p + "%";
                if(p >= 100) { clearInterval(itv); div.innerHTML = `<span style="color:white">[SUCCESS] ${t}: DATA BREACHED</span>`; }
            }, 200);
        });
    }

    renderHistory();
</script>
</body>
</html>
