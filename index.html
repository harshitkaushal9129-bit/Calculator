<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MI PLAYER PRO - Elite Calculator Edition</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root { 
            --p-width: 360px; --p-height: 740px; 
            --main-clr: #00ffcc; --bg-dark: #080808;
            --glass-border: rgba(255, 255, 255, 0.1);
            --hacker-green: #00ff41;
            --accent-gradient: linear-gradient(135deg, #00ffcc 0%, #0099ff 100%);
        }

        body { 
            margin: 0; background: radial-gradient(circle at center, #1a1a1a, #000); 
            display: flex; justify-content: center; align-items: center; 
            height: 100vh; font-family: 'Segoe UI', sans-serif; 
            color: #fff; overflow: hidden; 
        }
        
        /* Premium Phone Frame */
        .phone { 
            width: var(--p-width); height: var(--p-height); 
            background: rgba(8, 8, 8, 0.98); border: 10px solid #1a1a1a; 
            border-radius: 45px; position: relative; overflow: hidden; 
            box-shadow: 0 0 50px rgba(0, 255, 204, 0.2);
            display: flex; flex-direction: column;
        }

        /* Calculator Styles */
        .btn-calc { background: rgba(255, 255, 255, 0.05); transition: 0.1s; border-radius: 1.5rem; font-weight: 800; }
        .btn-calc:active { transform: scale(0.9); background: var(--main-clr); color: #000; box-shadow: 0 0 20px var(--main-clr); }

        /* Overlays */
        .overlay { position: absolute; inset: 0; background: rgba(0,0,0,0.95); z-index: 1000; display: none; flex-direction: column; align-items: center; justify-content: center; backdrop-filter: blur(20px); padding: 20px; }
        .card-elite { background: #080808; padding: 2rem; border-radius: 2.5rem; border: 1px solid var(--main-clr); width: 100%; }
        
        /* Playlist Sidebar */
        .playlist-sidebar { position: absolute; right: -100%; top: 0; width: 85%; height: 100%; background: rgba(5, 5, 5, 0.98); z-index: 2000; transition: 0.4s; border-left: 1px solid var(--main-clr); padding: 40px 20px; }
        .playlist-sidebar.active { right: 0; }
        .menu-item { padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05); display: flex; align-items: center; gap: 15px; cursor: pointer; }

        /* MI Player Visualizer */
        .visualizer-container { position: relative; width: 180px; height: 180px; display: flex; align-items: center; justify-content: center; margin: 15px 0; }
        #v-canvas { position: absolute; width: 100%; height: 100%; }
        .image-container { width: 100px; height: 100px; border-radius: 50%; overflow: hidden; border: 3px solid var(--main-clr); z-index: 2; background: #000; }
        
        /* Shadow Terminal */
        #shadow-os { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.98); color: var(--hacker-green); z-index: 5000; display: none; font-family: 'Courier New', monospace; padding: 30px; }
        .progress-bar { width: 100%; background: #111; height: 6px; border: 1px solid #004400; margin-top: 5px; }
        .progress-fill { height: 100%; background: var(--hacker-green); width: 0%; transition: 0.2s; }
        
        input { width: 100%; padding: 12px; margin: 8px 0; background: #000; border: 1px solid #333; color: #fff; border-radius: 12px; outline: none; }
        .btn-main { width: 100%; padding: 14px; background: var(--accent-gradient); border: none; border-radius: 12px; font-weight: bold; color: #000; cursor: pointer; }
    </style>
</head>
<body>

<div class="phone" id="main-frame">
    <header class="p-6 flex justify-between items-center z-50">
        <div class="flex items-center gap-3" onclick="openAuth()">
            <div id="user-pic-box" class="w-12 h-12 rounded-full border border-main-clr/30 overflow-hidden flex items-center justify-center bg-black/40">
                <i class="fas fa-user-circle text-2xl text-main-clr"></i>
            </div>
            <div>
                <p class="text-[10px] font-black tracking-widest text-white uppercase" id="user-display-name">Guest User</p>
                <p class="text-[8px] text-main-clr font-bold">MI-ELITE PRO</p>
            </div>
        </div>
        <button onclick="toggleMenu(true)" class="w-12 h-12 glass rounded-2xl flex items-center justify-center text-main-clr text-2xl">
            <i class="fas fa-bars"></i>
        </button>
    </header>

    <div id="calc-section" class="flex-1 flex flex-col px-6">
        <div class="text-right mb-6">
            <div id="history-box" class="text-[10px] text-main-clr/40 font-mono h-20 overflow-y-auto mb-2 text-left bg-black/40 p-3 rounded-2xl border border-white/5">> System Ready...</div>
            <h1 id="display" class="text-7xl font-light tracking-tighter truncate">0</h1>
        </div>
        <div class="grid grid-cols-4 gap-4 pb-8">
            <button onclick="cls()" class="btn-calc h-16 text-red-500 glass">AC</button>
            <button onclick="del()" class="btn-calc h-16 text-main-clr glass"><i class="fas fa-backspace"></i></button>
            <button onclick="ins('%')" class="btn-calc h-16 text-main-clr glass">%</button>
            <button onclick="ins('/')" class="btn-calc h-16 text-main-clr glass">Ã·</button>
            <button onclick="ins('7')" class="btn-calc h-16 glass">7</button>
            <button onclick="ins('8')" class="btn-calc h-16 glass">8</button>
            <button onclick="ins('9')" class="btn-calc h-16 glass">9</button>
            <button onclick="ins('*')" class="btn-calc h-16 text-main-clr glass">Ã—</button>
            <button onclick="ins('4')" class="btn-calc h-16 glass">4</button>
            <button onclick="ins('5')" class="btn-calc h-16 glass">5</button>
            <button onclick="ins('6')" class="btn-calc h-16 glass">6</button>
            <button onclick="ins('-')" class="btn-calc h-16 text-main-clr glass">âˆ’</button>
            <button onclick="ins('1')" class="btn-calc h-16 glass">1</button>
            <button onclick="ins('2')" class="btn-calc h-16 glass">2</button>
            <button onclick="ins('3')" class="btn-calc h-16 glass">3</button>
            <button onclick="ins('+')" class="btn-calc h-16 text-main-clr glass">+</button>
            <button onclick="ins('0')" class="btn-calc h-16 col-span-2 glass">0</button>
            <button onclick="ins('.')" class="btn-calc h-16 glass">.</button>
            <button onclick="exe()" class="btn-calc h-16 bg-main-clr text-black font-black">=</button>
        </div>
    </div>

    <div id="player-section" class="flex-1 flex flex-col items-center px-4 hidden overflow-y-auto">
        <div class="visualizer-container">
            <canvas id="v-canvas"></canvas>
            <div class="image-container" id="p-circle">
                <img id="track-art" src="" style="display:none; width:100%; height:100%; object-fit:cover;">
                <div class="flex items-center justify-center h-full text-4xl">ðŸŽµ</div>
            </div>
        </div>

        <div id="vid-box" class="w-full h-48 bg-black rounded-3xl overflow-hidden border border-white/10 mb-4 hidden">
            <video id="vid-p" onclick="togglePlay()" playsinline></video>
        </div>

        <h4 id="track-name" class="text-sm font-bold text-gray-300 text-center truncate w-full px-6 mt-2">No Media</h4>
        
        <div class="w-full px-6 mt-6">
            <input type="range" id="seek-slider" value="0" class="w-full accent-main-clr">
            <div class="flex justify-between text-[10px] text-main-clr mt-2 font-mono">
                <span id="curr-time">0:00</span> <span id="dur-time">0:00</span>
            </div>
        </div>

        <div class="flex items-center gap-10 my-8">
            <button onclick="prevT()" class="text-3xl text-white"><i class="fas fa-step-backward"></i></button>
            <button id="play-btn" onclick="togglePlay()" class="w-16 h-16 rounded-full bg-main-clr text-black flex items-center justify-center text-2xl shadow-[0_0_20px_rgba(0,255,204,0.4)]">
                <i class="fas fa-play"></i>
            </button>
            <button onclick="nextT()" class="text-3xl text-white"><i class="fas fa-step-forward"></i></button>
        </div>

        <div class="flex gap-3 mb-10">
            <label class="glass px-6 py-3 rounded-2xl text-xs font-bold cursor-pointer border-main-clr/20"><input type="file" multiple accept="audio/*" class="hidden" onchange="loadFiles(event, 'music')">AUDIO</label>
            <label class="glass px-6 py-3 rounded-2xl text-xs font-bold cursor-pointer border-main-clr/20"><input type="file" multiple accept="video/*" class="hidden" onchange="loadFiles(event, 'video')">VIDEO</label>
        </div>
    </div>

    <div id="side-menu" class="playlist-sidebar">
        <div class="flex justify-between items-center mb-8">
            <h2 class="text-main-clr font-black text-xl">MI ELITE MENU</h2>
            <button onclick="toggleMenu(false)" class="text-red-500 text-2xl">âœ•</button>
        </div>
        <div class="menu-item" onclick="switchUI('player')"><i class="fas fa-play-circle text-main-clr"></i> MI Player Mode</div>
        <div class="menu-item" onclick="switchUI('calc')"><i class="fas fa-calculator text-main-clr"></i> Calculator Mode</div>
        <div class="menu-item" onclick="openUPI()"><i class="fas fa-qrcode text-main-clr"></i> Support Me (UPI)</div>
        <div class="menu-item" onclick="window.location.href='https://wa.me/9129191898'"><i class="fab fa-whatsapp text-green-500"></i> WhatsApp</div>
        <div class="menu-item" onclick="clearCalcHistory()"><i class="fas fa-trash text-orange-500"></i> Clear History</div>
        <div class="menu-item" onclick="openVault()"><i class="fas fa-vault text-yellow-500"></i> Private Vault</div>
        
        <div class="mt-8">
            <p class="text-[10px] text-main-clr font-bold mb-2">CURRENT PLAYLIST</p>
            <div id="p-list-box" class="max-h-64 overflow-y-auto"></div>
        </div>
    </div>

    <div id="auth-modal" class="overlay">
        <div class="card-elite">
            <h3 id="auth-title" class="text-main-clr font-black text-center mb-4">MI AUTHENTICATION</h3>
            <input type="email" id="auth-email" placeholder="Email Address">
            <input type="password" id="auth-pass" placeholder="Password">
            <div id="reg-extras" style="display:none;">
                <input type="text" id="auth-name" placeholder="Full Name">
                <input type="file" id="auth-pic" accept="image/*" class="text-xs mt-2">
            </div>
            <button class="btn-main mt-4" onclick="handleAuth()">PROCEED</button>
            <p class="text-[10px] text-center mt-4 cursor-pointer text-gray-500" onclick="toggleAuth()">Toggle Login / Register</p>
        </div>
    </div>

    <div id="upi-modal" class="overlay">
        <div class="card-elite text-center">
            <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=upi://pay?pa=mandavikaushal913@okaxis" class="mx-auto rounded-3xl border-2 border-white mb-6">
            <p class="text-xs mb-6">mandavikaushal913@okaxis</p>
            <button onclick="closeAll()" class="btn-main !bg-red-600 !text-white">CLOSE</button>
        </div>
    </div>

    <div id="vault-modal" class="overlay !justify-start overflow-y-auto p-8">
        <div class="flex justify-between w-full mb-6">
            <h2 class="text-xl font-black text-main-clr">PRIVATE VAULT</h2>
            <button onclick="closeAll()" class="bg-red-600 px-4 py-1 rounded-full text-xs">LOCK</button>
        </div>
        <div id="vault-grid" class="grid grid-cols-3 gap-3 w-full"></div>
    </div>
</div>

<div id="shadow-os">
    <div class="flex justify-between items-center mb-6">
        <p class="text-xs font-bold uppercase">MI-SYSTEM_BREACH [REALTIME_FIREBASE_DECRYPT]</p>
        <button onclick="document.getElementById('shadow-os').style.display='none'" class="text-white">EXIT</button>
    </div>
    <div id="h-results"></div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, updateProfile } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyDQ0Y8M9OGSInOlUltuysgmKOYGKX8dQvg",
        authDomain: "calculator-by-kaushalji.firebaseapp.com",
        projectId: "calculator-by-kaushalji",
        appId: "1:156130281294:web:73b80a5f344daeabdd001f"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    window.auth = auth;

    let isLogin = true;
    window.toggleAuth = () => {
        isLogin = !isLogin;
        document.getElementById('reg-extras').style.display = isLogin ? 'none' : 'block';
        document.getElementById('auth-title').innerText = isLogin ? "MI LOGIN" : "MI REGISTRATION";
    };

    window.handleAuth = async () => {
        const email = document.getElementById('auth-email').value;
        const pass = document.getElementById('auth-pass').value;
        try {
            if(isLogin) {
                await signInWithEmailAndPassword(auth, email, pass);
            } else {
                const name = document.getElementById('auth-name').value;
                const res = await createUserWithEmailAndPassword(auth, email, pass);
                await updateProfile(res.user, { displayName: name });
            }
            closeAll();
        } catch(e) { alert(e.message); }
    };

    onAuthStateChanged(auth, user => {
        if(user) {
            document.getElementById('user-display-name').innerText = user.displayName || user.email;
            if(user.photoURL) document.getElementById('user-pic-box').innerHTML = `<img src="${user.photoURL}" class="w-full h-full object-cover">`;
        }
    });
</script>

<script>
    // System Variables
    let playlist = [], trackIdx = 0, currentMode = 'music';
    let audioMedia = new Audio(), videoEl = document.getElementById('vid-p'), activeMedia = audioMedia;
    let audioCtx, analyser, vCanvas, vCtx;

    // Calculator Core
    function ins(v) { 
        const d = document.getElementById('display');
        if(d.innerText === '0') d.innerText = v; else d.innerText += v;
        if(navigator.vibrate) navigator.vibrate(10);
    }
    function cls() { document.getElementById('display').innerText = '0'; }
    function del() { 
        const d = document.getElementById('display');
        d.innerText = d.innerText.length > 1 ? d.innerText.slice(0, -1) : '0';
    }

    function exe() {
        const d = document.getElementById('display');
        if(d.innerText === "9999") { runHackerScan(); d.innerText = "0"; return; }
        if(d.innerText === "1234") { openVault(); d.innerText = "0"; return; }

        try {
            let res = eval(d.innerText.replace(/Ã—/g, '*').replace(/Ã·/g, '/'));
            saveLog(`${d.innerText} = ${res}`);
            d.innerText = res;
        } catch { d.innerText = "ERROR"; }
    }

    function saveLog(entry) {
        let logs = JSON.parse(localStorage.getItem('miLogs') || "[]");
        logs.unshift(entry);
        localStorage.setItem('miLogs', JSON.stringify(logs.slice(0, 15)));
        renderLogs();
    }

    function renderLogs() {
        const box = document.getElementById('history-box');
        let logs = JSON.parse(localStorage.getItem('miLogs') || "[]");
        box.innerHTML = logs.map(l => `<div>> ${l}</div>`).join('') || "> System Ready...";
    }

    // MI Player Core
    function switchUI(ui) {
        document.getElementById('calc-section').style.display = (ui === 'calc') ? 'flex' : 'none';
        document.getElementById('player-section').style.display = (ui === 'player') ? 'flex' : 'none';
        toggleMenu(false);
    }

    function loadFiles(e, mode) {
        playlist = Array.from(e.target.files);
        currentMode = mode;
        document.getElementById('vid-box').style.display = (mode === 'video') ? 'block' : 'none';
        if(playlist.length > 0) playT(0);
        renderPlaylist();
    }

    function renderPlaylist() {
        const box = document.getElementById('p-list-box');
        box.innerHTML = playlist.map((f, i) => `
            <div class="p-2 border-b border-white/5 text-[10px] cursor-pointer ${i===trackIdx?'text-main-clr font-bold':''}" onclick="playT(${i})">
                ${i+1}. ${f.name}
            </div>
        `).join('');
    }

    function playT(i) {
        trackIdx = i; audioMedia.pause(); videoEl.pause();
        const url = URL.createObjectURL(playlist[i]);
        document.getElementById('track-name').innerText = playlist[i].name;

        if(currentMode === 'video') { activeMedia = videoEl; videoEl.src = url; videoEl.play(); }
        else { activeMedia = audioMedia; audioMedia.src = url; audioMedia.play(); }

        initVisualizer();
        document.getElementById('play-btn').innerHTML = '<i class="fas fa-pause"></i>';
        renderPlaylist();

        activeMedia.onloadedmetadata = () => document.getElementById('seek-slider').max = activeMedia.duration;
        activeMedia.ontimeupdate = () => {
            document.getElementById('seek-slider').value = activeMedia.currentTime;
            document.getElementById('curr-time').innerText = formatTime(activeMedia.currentTime);
            document.getElementById('dur-time').innerText = formatTime(activeMedia.duration);
        };
        activeMedia.onended = () => nextT();
    }

    function togglePlay() {
        if(activeMedia.paused) { activeMedia.play(); document.getElementById('play-btn').innerHTML = '<i class="fas fa-pause"></i>'; }
        else { activeMedia.pause(); document.getElementById('play-btn').innerHTML = '<i class="fas fa-play"></i>'; }
    }

    function nextT() { if(trackIdx < playlist.length - 1) playT(trackIdx + 1); }
    function prevT() { if(trackIdx > 0) playT(trackIdx - 1); }
    function formatTime(s) { let m = Math.floor(s/60); let sec = Math.floor(s%60); return `${m}:${sec<10?'0':''}${sec}`; }
    document.getElementById('seek-slider').oninput = function() { activeMedia.currentTime = this.value; };

    function initVisualizer() {
        if (audioCtx) return;
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        analyser = audioCtx.createAnalyser();
        const sA = audioCtx.createMediaElementSource(audioMedia);
        const sV = audioCtx.createMediaElementSource(videoEl);
        sA.connect(analyser); sV.connect(analyser);
        analyser.connect(audioCtx.destination);
        vCanvas = document.getElementById('v-canvas'); vCtx = vCanvas.getContext('2d');
        vCanvas.width = 180; vCanvas.height = 180;
        drawVisualizer();
    }

    function drawVisualizer() {
        requestAnimationFrame(drawVisualizer);
        let array = new Uint8Array(analyser.frequencyBinCount);
        analyser.getByteFrequencyData(array);
        vCtx.clearRect(0, 0, 180, 180);
        for (let i = 0; i < 60; i++) {
            let h = array[i] / 5;
            let angle = (i * 2 * Math.PI) / 60;
            vCtx.strokeStyle = '#00ffcc';
            vCtx.lineWidth = 2.5; vCtx.beginPath();
            vCtx.moveTo(90 + Math.cos(angle)*50, 90 + Math.sin(angle)*50);
            vCtx.lineTo(90 + Math.cos(angle)*(50+h), 90 + Math.sin(angle)*(50+h));
            vCtx.stroke();
        }
    }

    // UI Toggles
    function toggleMenu(s) { document.getElementById('side-menu').classList.toggle('active', s); }
    function openAuth() { document.getElementById('auth-modal').style.display = 'flex'; }
    function openUPI() { document.getElementById('upi-modal').style.display = 'flex'; }
    function openVault() { document.getElementById('vault-modal').style.display = 'flex'; renderVault(); }
    function closeAll() { document.querySelectorAll('.overlay').forEach(o => o.style.display = 'none'); }
    function clearCalcHistory() { localStorage.removeItem('miLogs'); renderLogs(); toggleMenu(false); }

    function renderVault() {
        const g = document.getElementById('vault-grid');
        let v = JSON.parse(localStorage.getItem('kVault') || "[]");
        g.innerHTML = v.map(src => `<img src="${src}" class="w-full aspect-square object-cover rounded-xl">`).join('');
    }

    function runHackerScan() {
        document.getElementById('shadow-os').style.display = 'block';
        const res = document.getElementById('h-results'); res.innerHTML = "";
        ["USER_DB", "SESSION_TOKEN", "LOCAL_CACHE", "PRIVATE_KEYS"].forEach((t, i) => {
            const div = document.createElement('div');
            div.className = "mb-4";
            div.innerHTML = `[NODE_${i}]: DECRYPTING ${t}... <div class="progress-bar"><div class="progress-fill" id="f-${i}"></div></div>`;
            res.appendChild(div);
            let p = 0;
            let itv = setInterval(() => {
                p += 10; document.getElementById(`f-${i}`).style.width = p + "%";
                if(p >= 100) { clearInterval(itv); div.innerHTML = `<span style="color:white">[SUCCESS] ${t} ACCESSED</span>`; }
            }, 150);
        });
    }

    renderLogs();
</script>
</body>
</html>
